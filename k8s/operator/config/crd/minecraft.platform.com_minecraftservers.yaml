---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  name: minecraftservers.minecraft.platform.com
spec:
  group: minecraft.platform.com
  names:
    kind: MinecraftServer
    listKind: MinecraftServerList
    plural: minecraftservers
    shortNames:
    - mcserver
    - mcs
    singular: minecraftserver
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.displayName
      name: Display Name
      type: string
    - jsonPath: .status.phase
      name: Status
      type: string
    - jsonPath: .status.playerCount
      name: Players
      type: string
    - jsonPath: .status.maxPlayers
      name: Max Players
      type: string
    - jsonPath: .status.version
      name: Version
      type: string
    - jsonPath: .status.externalIP
      name: External IP
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1
    schema:
      openAPIV3Schema:
        description: MinecraftServer is the Schema for the minecraftservers API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: MinecraftServerSpec defines the desired state of MinecraftServer
            properties:
              autoStart:
                description: AutoStart configuration for automatic startup when player
                  connects
                properties:
                  enabled:
                    default: false
                    description: Enabled indicates if auto-start should be enabled
                      (wake-on-connect)
                    type: boolean
                type: object
              autoStop:
                description: AutoStop configuration for automatic shutdown on inactivity
                properties:
                  enabled:
                    default: false
                    description: Enabled indicates if auto-stop should be enabled
                    type: boolean
                  idleTimeoutMinutes:
                    default: 3
                    description: IdleTimeoutMinutes is how long to wait with no players
                      before stopping
                    maximum: 1440
                    minimum: 1
                    type: integer
                type: object
              backup:
                description: Backup configuration
                properties:
                  enabled:
                    default: false
                    description: Enabled indicates if backups should be taken
                    type: boolean
                  retentionDays:
                    default: 7
                    description: RetentionDays is how many days to keep backups
                    type: integer
                  schedule:
                    default: 0 2 * * *
                    description: Schedule is the cron schedule for backups
                    type: string
                  storageClass:
                    description: StorageClass for backup storage
                    type: string
                type: object
              config:
                description: Config contains the server configuration
                properties:
                  additionalProperties:
                    additionalProperties:
                      type: string
                    description: Additional server properties as key-value pairs
                    type: object
                  allowFlight:
                    default: false
                    description: AllowFlight allows players to fly (useful for creative
                      mode)
                    type: boolean
                  allowNether:
                    default: true
                    description: AllowNether enables the Nether dimension
                    type: boolean
                  difficulty:
                    default: normal
                    description: Difficulty is the game difficulty
                    enum:
                    - peaceful
                    - easy
                    - normal
                    - hard
                    type: string
                  enableCommandBlock:
                    default: true
                    description: EnableCommandBlock enables command blocks
                    type: boolean
                  forceGamemode:
                    default: false
                    description: ForceGamemode forces players into the default gamemode
                      on join
                    type: boolean
                  gamemode:
                    default: survival
                    description: Gamemode is the default game mode
                    enum:
                    - survival
                    - creative
                    - adventure
                    - spectator
                    type: string
                  generateStructures:
                    default: true
                    description: GenerateStructures enables structure generation (villages,
                      temples, etc.)
                    type: boolean
                  hardcoreMode:
                    default: false
                    description: HardcoreMode enables hardcore mode (death = permanent
                      ban)
                    type: boolean
                  levelName:
                    default: world
                    description: LevelName is the world name
                    type: string
                  levelSeed:
                    description: LevelSeed is the world generation seed (optional)
                    type: string
                  levelType:
                    default: default
                    description: LevelType is the world generation type
                    enum:
                    - default
                    - flat
                    - largeBiomes
                    - amplified
                    - singleBiome
                    type: string
                  maxPlayers:
                    default: 20
                    description: MaxPlayers is the maximum number of players
                    type: integer
                  motd:
                    default: A Minecraft Server powered by Kubernetes
                    description: MOTD is the message of the day
                    type: string
                  onlineMode:
                    default: true
                    description: OnlineMode enables online mode
                    type: boolean
                  pvp:
                    default: true
                    description: PVP enables player vs player combat
                    type: boolean
                  simulationDistance:
                    default: 10
                    description: SimulationDistance is the simulation distance in
                      chunks (3-32)
                    maximum: 32
                    minimum: 3
                    type: integer
                  spawnAnimals:
                    default: true
                    description: SpawnAnimals enables animal spawning
                    type: boolean
                  spawnMonsters:
                    default: true
                    description: SpawnMonsters enables monster spawning
                    type: boolean
                  spawnNPCs:
                    default: true
                    description: SpawnNPCs enables NPC spawning (villagers)
                    type: boolean
                  spawnProtection:
                    default: 16
                    description: SpawnProtection is the radius around spawn that is
                      protected (0 = disabled)
                    maximum: 1000
                    minimum: 0
                    type: integer
                  viewDistance:
                    default: 10
                    description: ViewDistance is the render distance in chunks (3-32)
                    maximum: 32
                    minimum: 3
                    type: integer
                  whiteList:
                    default: false
                    description: WhiteList enables whitelist mode
                    type: boolean
                type: object
              displayName:
                description: DisplayName is the user-friendly name shown in the UI
                maxLength: 64
                minLength: 1
                type: string
              image:
                default: itzg/minecraft-server:latest
                description: Image is the Docker image to use for the Minecraft server
                type: string
              plugins:
                description: Plugins is a list of plugins to install
                items:
                  description: MinecraftPlugin defines a plugin to install
                  properties:
                    config:
                      additionalProperties:
                        type: string
                      description: Config for the plugin
                      type: object
                    enabled:
                      default: true
                      description: Enabled indicates if the plugin should be enabled
                      type: boolean
                    name:
                      description: Name of the plugin
                      type: string
                    url:
                      description: URL to download the plugin from
                      type: string
                    version:
                      description: Version of the plugin
                      type: string
                  required:
                  - name
                  type: object
                type: array
              rconPassword:
                description: |-
                  RCONPassword is the unique password for this server's RCON access
                  This is auto-generated when the server is created
                type: string
              resources:
                description: Resources defines the resource requirements for the server
                properties:
                  cpuLimit:
                    anyOf:
                    - type: integer
                    - type: string
                    description: CPU limit (e.g., "2000m")
                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                    x-kubernetes-int-or-string: true
                  cpuRequest:
                    anyOf:
                    - type: integer
                    - type: string
                    description: CPU request (e.g., "1000m")
                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                    x-kubernetes-int-or-string: true
                  memory:
                    description: Memory allocation for JVM (e.g., "3G")
                    type: string
                  memoryLimit:
                    anyOf:
                    - type: integer
                    - type: string
                    description: Memory limit (e.g., "4Gi")
                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                    x-kubernetes-int-or-string: true
                  memoryRequest:
                    anyOf:
                    - type: integer
                    - type: string
                    description: Memory request (e.g., "2Gi")
                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                    x-kubernetes-int-or-string: true
                  storage:
                    anyOf:
                    - type: integer
                    - type: string
                    description: Storage size (e.g., "10Gi")
                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                    x-kubernetes-int-or-string: true
                required:
                - cpuLimit
                - cpuRequest
                - memory
                - memoryLimit
                - memoryRequest
                - storage
                type: object
              serverId:
                description: |-
                  ServerID is the unique UUID identifier for this server instance
                  This is the primary identifier used throughout the system
                type: string
              serverType:
                default: VANILLA
                description: ServerType is the type of Minecraft server to run
                enum:
                - VANILLA
                - PAPER
                - SPIGOT
                - BUKKIT
                - FORGE
                - FABRIC
                - PURPUR
                - QUILT
                - NEOFORGE
                type: string
              stopped:
                default: false
                description: Stopped indicates if the server should be stopped (scaled
                  to 0 replicas)
                type: boolean
              storageClass:
                default: standard
                description: StorageClass is the storage class to use for persistent
                  volumes
                type: string
              tenantId:
                description: TenantID is the tenant that owns this server
                type: string
              version:
                default: 1.20.1
                description: Version is the Minecraft version to run
                type: string
            required:
            - config
            - displayName
            - resources
            - serverId
            - tenantId
            type: object
          status:
            description: MinecraftServerStatus defines the observed state of MinecraftServer
            properties:
              autoStoppedAt:
                description: AutoStoppedAt is when the server was auto-stopped (for
                  auto-start wake tracking)
                format: date-time
                type: string
              externalIP:
                description: ExternalIP is the external IP address of the server
                type: string
              installedPlugins:
                description: Plugins is the list of installed plugins
                items:
                  description: InstalledPlugin represents an installed plugin
                  properties:
                    enabled:
                      description: Enabled indicates if the plugin is enabled
                      type: boolean
                    name:
                      description: Name of the plugin
                      type: string
                    status:
                      description: Status of the plugin
                      type: string
                    version:
                      description: Version of the installed plugin
                      type: string
                  required:
                  - enabled
                  - name
                  - status
                  - version
                  type: object
                type: array
              lastBackup:
                description: LastBackup is the timestamp of the last successful backup
                format: date-time
                type: string
              lastPlayerActivity:
                description: LastPlayerActivity is when players were last online (for
                  auto-stop)
                format: date-time
                type: string
              lastUpdated:
                description: LastUpdated is the last time the status was updated
                format: date-time
                type: string
              maxPlayers:
                description: MaxPlayers is the maximum number of players
                type: integer
              message:
                description: Message provides additional information about the current
                  state
                type: string
              phase:
                description: Phase represents the current phase of the server
                enum:
                - Pending
                - Starting
                - Running
                - Stopping
                - Stopped
                - Error
                type: string
              playerCount:
                description: PlayerCount is the current number of players online
                type: integer
              port:
                description: Port is the external port of the server
                format: int32
                type: integer
              resourceUsage:
                description: Resources shows current resource usage
                properties:
                  cpu:
                    anyOf:
                    - type: integer
                    - type: string
                    description: CPU usage in millicores
                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                    x-kubernetes-int-or-string: true
                  memory:
                    anyOf:
                    - type: integer
                    - type: string
                    description: Memory usage in bytes
                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                    x-kubernetes-int-or-string: true
                  networkIO:
                    description: Network input/output stats
                    properties:
                      rxBytes:
                        description: Bytes received
                        format: int64
                        type: integer
                      txBytes:
                        description: Bytes transmitted
                        format: int64
                        type: integer
                    required:
                    - rxBytes
                    - txBytes
                    type: object
                  storage:
                    anyOf:
                    - type: integer
                    - type: string
                    description: Storage usage in bytes
                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                    x-kubernetes-int-or-string: true
                type: object
              version:
                description: Version is the current Minecraft version
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
